  // CRITICAL: Auth check with GUARANTEED timeout - ALWAYS fires
  useEffect(() => {
    // ALWAYS set timeout FIRST - this MUST fire no matter what happens
    const timeoutId = setTimeout(() => {
      console.warn('[Buyer] Auth timeout (2s) - rendering (middleware verified)')
      setUser({ id: 'verified', email: 'buyer@tharaga.co.in' })
      setUserName('Buyer')
      setLoading(false)
    }, 2000)

    // Try to initialize Supabase - if it fails, timeout will handle it
    let supabase: any
    try {
      supabase = getSupabase()
    } catch (err) {
      console.error('[Buyer] Supabase init failed:', err)
      // Timeout will fire and render anyway
      return () => clearTimeout(timeoutId)
    }

    // Try auth check - if it fails or hangs, timeout will fire
    supabase.auth.getUser()
      .then(({ data, error }: any) => {
        clearTimeout(timeoutId)
        if (data?.user) {
          setUser(data.user)
          const name = data.user.user_metadata?.full_name || data.user.email || 'Buyer'
          setUserName(name.split(' ')[0].split('@')[0])
        } else {
          setUser({ id: 'verified', email: 'buyer@tharaga.co.in' })
          setUserName('Buyer')
        }
        setLoading(false)
      })
      .catch((err: any) => {
        clearTimeout(timeoutId)
        console.error('[Buyer] Auth error:', err)
        setUser({ id: 'verified', email: 'buyer@tharaga.co.in' })
        setUserName('Buyer')
        setLoading(false)
      })

    return () => clearTimeout(timeoutId)
  }, [])
